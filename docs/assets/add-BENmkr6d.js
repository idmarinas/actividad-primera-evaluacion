import{m as W,l as g,e as P,o as r,c as m,a as I,w as h,h as V,F as k,r as F,t as w,p as C,q as A,v as _,d as n,x as p,b as a,_ as E,u as O,y as B,f as G,z as R}from"./index-DHnoSDYb.js";import{A as j}from"./add-BOs-Qe4q.js";import{c as H,_ as q,u as J}from"./alert-D-VnYJEd.js";const K={class:"space-y-1"},Q={class:"col-span-2 flex gap-3 items-center"},X={key:1,class:"flex-1 flex gap-0"},Y={class:"col-span-full"},Z={class:"col-span-full grid grid-cols-3 gap-3"},ee={class:"flex gap-3 items-center"},se={class:"flex gap-3 items-center"},le={class:"flex gap-3 items-center"},ne={class:"flex gap-3 items-center"},ie={class:"flex gap-3 items-center"},de={class:"flex gap-3 items-center"},oe={__name:"piece",props:W({isEdit:Boolean},{id:{},idModifiers:{},order:{},orderModifiers:{},dimensionsLength:{},dimensionsLengthModifiers:{},dimensionsWidth:{},dimensionsWidthModifiers:{},dimensionsThickness:{},dimensionsThicknessModifiers:{},color:{},colorModifiers:{},bothFaces:{type:Boolean},bothFacesModifiers:{},cut:{type:Boolean},cutModifiers:{},errors:{},errorsModifiers:{}}),emits:["update:id","update:order","update:dimensionsLength","update:dimensionsWidth","update:dimensionsThickness","update:color","update:bothFaces","update:cut","update:errors"],setup(f){const M=H(),z=f,b=g(f,"id"),y=g(f,"order"),i=g(f,"dimensionsLength"),N=g(f,"dimensionsWidth"),D=g(f,"dimensionsThickness"),x=g(f,"color"),T=g(f,"bothFaces",{set:c=>!!c}),U=g(f,"cut",{set:c=>!!c}),l=g(f,"errors"),S=P(()=>{let c=!0;for(let s in l.value)if(s==="dimensions")for(let d in l.value[s])l.value[s][d].length>0&&(c=!1);else l.value[s].length>0&&(c=!1);return c});function L(){b.value=M.generatePieceId()}return(c,s)=>(r(),m(k,null,[S.value?C("",!0):(r(),I(q,{key:0,type:"error",class:"col-span-full"},{title:h(()=>s[10]||(s[10]=[V(" La información de la pieza contiene errores ")])),default:h(()=>[(r(!0),m(k,null,F(l.value,d=>(r(),m("div",K,[(r(!0),m(k,null,F(d,e=>(r(),m("div",null,w(typeof e=="string"?e:e[0]),1))),256))]))),256))]),_:1})),A(n("input",{type:"hidden","onUpdate:modelValue":s[0]||(s[0]=d=>y.value=d)},null,512),[[_,y.value]]),n("div",Q,[s[12]||(s[12]=n("label",{for:"piece_id"},"Nº de pedido",-1)),z.isEdit?(r(),I(p,{key:0,error:l.value.id.length>0,type:"number",readonly:"",class:"rounded-lg flex-1",id:"piece_id",modelValue:b.value,"onUpdate:modelValue":s[1]||(s[1]=d=>b.value=d)},null,8,["error","modelValue"])):(r(),m("div",X,[a(p,{error:l.value.id.length>0,type:"number",readonly:"",class:"rounded-l-lg flex-1",id:"piece_id",modelValue:b.value,"onUpdate:modelValue":s[2]||(s[2]=d=>b.value=d)},null,8,["error","modelValue"]),a(E,{class:"rounded-r-lg",onClick:s[3]||(s[3]=d=>L()),disabled:b.value!==void 0},{default:h(()=>s[11]||(s[11]=[V("Generar")])),_:1},8,["disabled"])]))]),n("div",Y,[s[16]||(s[16]=n("h5",null,"Dimensiones",-1)),n("div",Z,[n("div",ee,[s[13]||(s[13]=n("label",{for:"piece_dimensions_length"},"Largo (cm)",-1)),a(p,{error:l.value.dimensions.length.length>0,class:"rounded-lg flex-1",type:"number",id:"piece_dimensions_length",modelValue:i.value,"onUpdate:modelValue":s[4]||(s[4]=d=>i.value=d),step:"1"},null,8,["error","modelValue"])]),n("div",se,[s[14]||(s[14]=n("label",{for:"piece_dimensions_width"},"Ancho (cm)",-1)),a(p,{error:l.value.dimensions.width.length>0,class:"rounded-lg flex-1",type:"number",id:"piece_dimensions_width",modelValue:N.value,"onUpdate:modelValue":s[5]||(s[5]=d=>N.value=d),step:"1"},null,8,["error","modelValue"])]),n("div",le,[s[15]||(s[15]=n("label",{for:"piece_dimensions_thickness"},"Grosor (cm)",-1)),a(p,{error:l.value.dimensions.thickness.length>0,class:"rounded-lg flex-1",type:"number",id:"piece_dimensions_thickness",modelValue:D.value,"onUpdate:modelValue":s[6]||(s[6]=d=>D.value=d),step:"1"},null,8,["error","modelValue"])])])]),n("div",ne,[s[17]||(s[17]=n("label",{for:"piece_color"},"Color chapado",-1)),a(p,{error:l.value.color.length>0,class:"rounded-lg flex-1",type:"text",id:"piece_color",modelValue:x.value,"onUpdate:modelValue":s[7]||(s[7]=d=>x.value=d)},null,8,["error","modelValue"])]),n("div",ie,[a(p,{type:"checkbox",id:"piece_bothFaces",modelValue:T.value,"onUpdate:modelValue":s[8]||(s[8]=d=>T.value=d)},null,8,["modelValue"]),s[18]||(s[18]=n("label",{for:"piece_bothFaces"},"¿Ambas caras?",-1))]),n("div",de,[a(p,{type:"checkbox",id:"piece_cut",modelValue:U.value,"onUpdate:modelValue":s[9]||(s[9]=d=>U.value=d)},null,8,["modelValue"]),s[19]||(s[19]=n("label",{for:"piece_cut"},"¿Cortada?",-1))])],64))}},te={class:"space-y-1"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ae={class:"flex gap-3 items-center"},ue={key:1,class:"flex-1 flex gap-0"},me={class:"flex gap-3 items-center"},pe={class:"flex gap-3 items-center"},fe={class:"flex gap-3 items-center"},ce={class:"flex-1"},ve={class:"flex gap-3 items-center"},ge={class:"col-span-full flex items-center gap-3"},he={key:0,class:"flex-1 text-red-700"},be={class:"col-span-full grid grid-cols-1 divide-y-2 divide-gold-sand-500"},ye={class:"col-span-full flex gap-3 mb-3"},Ue={__name:"add",props:{id:String},setup(f){const M=R(),z=O(),b=f,y=J(),i=B(y.find(b.id));i.value.served=i.value.serverd!==void 0;function N(){i.value.id=y.generateOrderId()}function D(){return i.value.id!==void 0}const x=D();function T(){var t,v;if(((v=(t=i.value)==null?void 0:t.pieces)==null?void 0:v.length)<1)return"Todavia no se han agregado piezas al pedido";let d=y.process(i.value);return`${d===void 0?"¿?":d.toLocaleString(Intl.Locale,{style:"percent"})}`}function U(){return i.value.id!==void 0}const l=B({invalid:[],id:[],client:[],orderDate:[],pieces:[]});function S(){i.value.pieces.push({order:i.value.id,dimensions:{},bothFaces:!1,cut:!1}),l.value.pieces.push({id:[],dimensions:{length:[],width:[],thickness:[]},color:[]})}const L=P(()=>{let d=!0;for(let e in l.value){if(e==="pieces"){l.value[e].forEach(t=>{for(let v in t){if(v==="dimensions")for(let o in t[v])t[v][o].length>0&&(d=!1);t[v].length>0&&(d=!1)}});continue}l.value[e].length>0&&(d=!1)}return d});function c(){delete l.value.invalid,i.value.id===void 0||!Number.isInteger(i.value.id)?l.value.id=['Genera un Número de pedido usando el botón de "Generar" y consta de números enteros']:l.value.id=[],typeof i.value.client!="string"||i.value.client.length<5?l.value.client=["Se debe poner el nombre y apellidos de cliente y debe tener como mínimo 5 letras"]:l.value.client=[];const d=new Date(i.value.orderDate);isNaN(d.getTime())||new Date().getTime()<d.getTime()?l.value.orderDate=["La fecha no tiene un formato válido y no puede ser una fecha posterior a la fecha actual"]:l.value.orderDate=[],i.value.pieces.length<1?l.value.piecesEmpty=["Se debe poner como mínimo una pieza en el pedido"]:l.value.piecesEmpty=[],i.value.pieces.length>0&&i.value.pieces.forEach((e,t)=>{e.id===void 0||!Number.isInteger(e.id)?l.value.pieces[t].id=['Genera un Número para pieza usando el botón de "Generar"']:l.value.pieces[t].id=[],e.dimensions.length===void 0||!Number.isInteger(e.dimensions.length)||e.dimensions.length<1?l.value.pieces[t].dimensions.length=["El largo de la pieza tiene que estar definido ser un número entero y mayor que 0"]:l.value.pieces[t].dimensions.length=[],e.dimensions.width===void 0||!Number.isInteger(e.dimensions.width)||e.dimensions.width<1?l.value.pieces[t].dimensions.width=["El ancho de la pieza tiene que estar definido ser un número entero y mayor que 0"]:l.value.pieces[t].dimensions.width=[],e.dimensions.thickness===void 0||!Number.isInteger(e.dimensions.thickness)||e.dimensions.thickness<1?l.value.pieces[t].dimensions.thickness=["El grosor de la pieza tiene que estar definido ser un número entero y mayor que 0"]:l.value.pieces[t].dimensions.thickness=[]})}function s(){y.add(i.value),M.push({name:"order_details",params:{id:i.value.id}})}return z.title=x?"Editar pedido":"Crear pedido",(d,e)=>{var t,v;return r(),m(k,null,[!L.value&&!l.value.invalid?(r(),I(q,{key:0,type:"error"},{title:h(()=>e[9]||(e[9]=[V(" El formulario contiene errores ")])),default:h(()=>[(r(!0),m(k,null,F(l.value,(o,$)=>(r(),m("div",te,[$!=="pieces"?(r(!0),m(k,{key:0},F(o,u=>(r(),m("div",null,w(u),1))),256)):C("",!0)]))),256))]),_:1})):C("",!0),n("form",re,[e[19]||(e[19]=n("h2",{class:"col-span-full"},"Datos del pedido",-1)),n("div",ae,[e[11]||(e[11]=n("label",{for:"order_id"},"Nº de pedido",-1)),G(x)?(r(),I(p,{key:0,type:"number",readonly:"",class:"rounded-lg flex-1",id:"order_id",modelValue:i.value.id,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value.id=o)},null,8,["modelValue"])):(r(),m("div",ue,[a(p,{error:l.value.id.length>0,type:"number",readonly:"",class:"rounded-l-lg flex-1",id:"order_id",modelValue:i.value.id,"onUpdate:modelValue":e[1]||(e[1]=o=>i.value.id=o)},null,8,["error","modelValue"]),a(E,{class:"rounded-r-lg",onClick:e[2]||(e[2]=o=>N()),disabled:i.value.id!==void 0},{default:h(()=>e[10]||(e[10]=[V("Generar")])),_:1},8,["disabled"])]))]),n("div",me,[e[12]||(e[12]=n("label",{for:"order_client"},"Cliente",-1)),a(p,{error:l.value.client.length>0,type:"text",class:"rounded-lg flex-1",id:"order_client",modelValue:i.value.client,"onUpdate:modelValue":e[3]||(e[3]=o=>i.value.client=o)},null,8,["error","modelValue"])]),n("div",pe,[e[13]||(e[13]=n("label",{for:"order_date"},"Fecha pedido",-1)),a(p,{error:l.value.orderDate.length>0,type:"datetime-local",class:"rounded-lg flex-1",id:"order_date",modelValue:i.value.orderDate,"onUpdate:modelValue":e[4]||(e[4]=o=>i.value.orderDate=o)},null,8,["error","modelValue"])]),n("div",fe,[e[14]||(e[14]=n("label",null,"Procesado",-1)),n("div",ce,w(T()),1)]),n("div",ve,[a(p,{type:"checkbox",class:"rounded-lg",id:"order_served",modelValue:i.value.served,"onUpdate:modelValue":e[5]||(e[5]=o=>i.value.served=o)},null,8,["modelValue"]),e[15]||(e[15]=n("label",{for:"order_served"},"Servido",-1))]),e[20]||(e[20]=n("h3",{class:"col-span-full"},"Piezas encargadas",-1)),n("div",ge,[a(E,{onClick:e[6]||(e[6]=o=>S()),"button-style":U()?"success":"warning",class:"rounded-lg",icon:!0,disabled:!U()},{default:h(()=>[a(j,{width:"24"}),V(" "+w(U()?"Añadir pieza":"Crea un ID para el pedido"),1)]),_:1},8,["button-style","disabled"]),((v=(t=l.value)==null?void 0:t.piecesEmpty)==null?void 0:v.length)>0?(r(),m("div",he,w(l.value.piecesEmpty[0]),1)):C("",!0)]),n("div",be,[(r(!0),m(k,null,F(i.value.pieces,(o,$)=>(r(),m("div",{key:$,class:"grid grid-cols-3 gap-3 py-3"},[a(oe,{isEdit:G(x),id:o.id,"onUpdate:id":u=>o.id=u,"dimensions-length":o.dimensions.length,"onUpdate:dimensionsLength":u=>o.dimensions.length=u,"dimensions-width":o.dimensions.width,"onUpdate:dimensionsWidth":u=>o.dimensions.width=u,"dimensions-thickness":o.dimensions.thickness,"onUpdate:dimensionsThickness":u=>o.dimensions.thickness=u,color:o.color,"onUpdate:color":u=>o.color=u,"both-faces":o.bothFaces,"onUpdate:bothFaces":u=>o.bothFaces=u,cut:o.cut,"onUpdate:cut":u=>o.cut=u,errors:l.value.pieces[$],"onUpdate:errors":u=>l.value.pieces[$]=u},null,8,["isEdit","id","onUpdate:id","dimensions-length","onUpdate:dimensionsLength","dimensions-width","onUpdate:dimensionsWidth","dimensions-thickness","onUpdate:dimensionsThickness","color","onUpdate:color","both-faces","onUpdate:bothFaces","cut","onUpdate:cut","errors","onUpdate:errors"])]))),128))]),n("div",ye,[e[18]||(e[18]=n("div",{class:"flex-1"},null,-1)),a(E,{class:"rounded-lg",onClick:e[7]||(e[7]=o=>c())},{default:h(()=>e[16]||(e[16]=[V("Validar datos")])),_:1}),a(E,{"button-style":"success",class:"rounded-lg",disabled:!L.value,onClick:e[8]||(e[8]=o=>s())},{default:h(()=>e[17]||(e[17]=[V("Guardar pedido")])),_:1},8,["disabled"])])])],64)}}};export{Ue as default};
//# sourceMappingURL=add-BENmkr6d.js.map
