import{m as j,l as v,o as a,c as p,p as R,v as H,d,a as B,q as u,b as i,w as b,h as V,_ as $,F as k,u as J,x as G,e as K,y as z,f as _,t as w,i as S,z as Q}from"./index-8Df-Y6q0.js";import{A as X}from"./add-MVcK18HJ.js";import{c as Y,u as Z,_ as ee}from"./alert-DFuKHJHo.js";const le={class:"col-span-2 flex gap-3 items-center"},de={key:1,class:"flex-1 flex gap-0"},se={class:"col-span-full"},oe={class:"col-span-full grid grid-cols-3 gap-3"},ne={class:"flex gap-3 items-center"},te={class:"flex gap-3 items-center"},ie={class:"flex gap-3 items-center"},ae={class:"flex gap-3 items-center"},re={class:"flex gap-3 items-center"},ue={class:"flex gap-3 items-center"},me={__name:"add",props:j({isEdit:Boolean},{id:{},idModifiers:{},order:{},orderModifiers:{},dimensionsLength:{},dimensionsLengthModifiers:{},dimensionsWidth:{},dimensionsWidthModifiers:{},dimensionsThickness:{},dimensionsThicknessModifiers:{},color:{},colorModifiers:{},bothFaces:{type:Boolean},bothFacesModifiers:{},cut:{type:Boolean},cutModifiers:{}}),emits:["update:id","update:order","update:dimensionsLength","update:dimensionsWidth","update:dimensionsThickness","update:color","update:bothFaces","update:cut"],setup(m){const L=Y(),C=m,f=v(m,"id"),c=v(m,"order"),s=v(m,"dimensionsLength"),F=v(m,"dimensionsWidth"),E=v(m,"dimensionsThickness"),x=v(m,"color"),T=v(m,"bothFaces",{set(n){return n=!!n,n}}),y=v(m,"cut",{set(n){return n=!!n,n}});function M(){f.value=L.generatePieceId()}return(n,l)=>(a(),p(k,null,[R(d("input",{type:"hidden","onUpdate:modelValue":l[0]||(l[0]=t=>c.value=t)},null,512),[[H,c.value]]),d("div",le,[l[11]||(l[11]=d("label",{for:"piece_id"},"Nº de pedido",-1)),C.isEdit?(a(),B(u,{key:0,type:"number",class:"rounded-lg flex-1",id:"piece_id",modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=t=>f.value=t)},null,8,["modelValue"])):(a(),p("div",de,[i(u,{type:"number",readonly:"",class:"rounded-l-lg flex-1",id:"piece_id",modelValue:f.value,"onUpdate:modelValue":l[2]||(l[2]=t=>f.value=t)},null,8,["modelValue"]),i($,{class:"rounded-r-lg",onClick:l[3]||(l[3]=t=>M()),disabled:f.value!==void 0},{default:b(()=>l[10]||(l[10]=[V("Generar")])),_:1},8,["disabled"])]))]),d("div",se,[l[15]||(l[15]=d("h5",null,"Dimensiones",-1)),d("div",oe,[d("div",ne,[l[12]||(l[12]=d("label",{for:"piece_dimensions_length"},"Largo (cm)",-1)),i(u,{class:"rounded-lg flex-1",type:"number",id:"piece_dimensions_length",modelValue:s.value,"onUpdate:modelValue":l[4]||(l[4]=t=>s.value=t),step:"1"},null,8,["modelValue"])]),d("div",te,[l[13]||(l[13]=d("label",{for:"piece_dimensions_width"},"Ancho (cm)",-1)),i(u,{class:"rounded-lg flex-1",type:"number",id:"piece_dimensions_width",modelValue:F.value,"onUpdate:modelValue":l[5]||(l[5]=t=>F.value=t),step:"1"},null,8,["modelValue"])]),d("div",ie,[l[14]||(l[14]=d("label",{for:"piece_dimensions_thickness"},"Grosor (cm)",-1)),i(u,{class:"rounded-lg flex-1",type:"number",id:"piece_dimensions_thickness",modelValue:E.value,"onUpdate:modelValue":l[6]||(l[6]=t=>E.value=t),step:"1"},null,8,["modelValue"])])])]),d("div",ae,[l[16]||(l[16]=d("label",{for:"piece_color"},"Color chapado",-1)),i(u,{class:"rounded-lg flex-1",type:"text",id:"piece_color",modelValue:x.value,"onUpdate:modelValue":l[7]||(l[7]=t=>x.value=t)},null,8,["modelValue"])]),d("div",re,[i(u,{type:"checkbox",id:"piece_bothFaces",modelValue:T.value,"onUpdate:modelValue":l[8]||(l[8]=t=>T.value=t)},null,8,["modelValue"]),l[17]||(l[17]=d("label",{for:"piece_bothFaces"},"¿Ambas caras?",-1))]),d("div",ue,[i(u,{type:"checkbox",id:"piece_cut",modelValue:y.value,"onUpdate:modelValue":l[9]||(l[9]=t=>y.value=t)},null,8,["modelValue"]),l[18]||(l[18]=d("label",{for:"piece_cut"},"¿Cortada?",-1))])],64))}},pe={class:"space-y-1"},fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve={class:"flex gap-3 items-center"},ce={key:1,class:"flex-1 flex gap-0"},ge={class:"flex gap-3 items-center"},be={class:"flex gap-3 items-center"},Ve={class:"flex gap-3 items-center"},xe={class:"flex-1"},ye={class:"flex gap-3 items-center"},ke={class:"col-span-full flex items-center gap-3"},Ue={key:0,class:"flex-1 text-red-700"},he={class:"col-span-full grid grid-cols-1 divide-y-2 divide-gold-sand-500"},$e={class:"col-span-full flex gap-3 mb-3"},we={__name:"add",props:{id:String},setup(m){const L=Q(),C=J(),f=m,c=Z(),s=G(c.find(f.id));s.value.served=!1;function F(){s.value.id=c.generateOrderId()}function E(){return s.value.id!==void 0}const x=E();function T(){var U,h;if(((h=(U=s.value)==null?void 0:U.pieces)==null?void 0:h.length)<1)return"Todavia no se han agregado piezas al pedido";let g=c.process(s.value);return`${g===void 0?"¿?":g.toLocaleString(Intl.Locale,{style:"percent"})}`}function y(){return s.value.id!==void 0}function M(){s.value.pieces.push({order:s.value.id,dimensions:{},bothFaces:!1,cut:!1})}const n=G({invalid:[]}),l=K(g=>Object.keys(n.value).length<1);function t(){delete n.value.invalid,s.value.id===void 0?n.value.id=['Genera un Número de pedido usando el botón de "Generar"']:delete n.value.id,typeof s.value.client!="string"||s.value.client.length<5?n.value.client=["Se debe poner el nombre y apellidos de cliente y debe tener como mínimo 5 letras"]:delete n.value.client;const g=new Date(s.value.dateOrder);isNaN(g.getTime())||new Date().getTime()<g.getTime()?n.value.dateOrder=["La fecha no tiene un formato válido","La fecha puede que sea posterior a la fecha actual"]:delete n.value.dateOrder,s.value.pieces.length<1?n.value.piecesEmpty=["Se debe poner como mínimo una pieza en el pedido"]:delete n.value.piecesEmpty}function q(){c.add(s.value),L.push({name:"order_details",params:{id:s.value.id}})}return C.title=x?"Editar pedido":"Crear pedido",(g,e)=>{var U,h,N,P,D,I,W,A;return a(),p(k,null,[!l.value&&!n.value.invalid?(a(),B(ee,{key:0,type:"error"},{title:b(()=>e[9]||(e[9]=[V(" El formulario contiene errores ")])),default:b(()=>[(a(!0),p(k,null,S(n.value,o=>(a(),p("div",pe,[(a(!0),p(k,null,S(o,O=>(a(),p(k,null,[V(w(O),1),e[10]||(e[10]=d("br",null,null,-1))],64))),256))]))),256))]),_:1})):z("",!0),d("form",fe,[e[20]||(e[20]=d("h2",{class:"col-span-full"},"Datos del pedido",-1)),d("div",ve,[e[12]||(e[12]=d("label",{for:"order_id"},"Nº de pedido",-1)),_(x)?(a(),B(u,{key:0,type:"number",readonly:"",class:"rounded-lg flex-1",id:"order_id",modelValue:s.value.id,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value.id=o)},null,8,["modelValue"])):(a(),p("div",ce,[i(u,{error:((h=(U=n.value)==null?void 0:U.id)==null?void 0:h.length)>0,type:"number",readonly:"",class:"rounded-l-lg flex-1",id:"order_id",modelValue:s.value.id,"onUpdate:modelValue":e[1]||(e[1]=o=>s.value.id=o)},null,8,["error","modelValue"]),i($,{class:"rounded-r-lg",onClick:e[2]||(e[2]=o=>F()),disabled:s.value.id!==void 0},{default:b(()=>e[11]||(e[11]=[V("Generar")])),_:1},8,["disabled"])]))]),d("div",ge,[e[13]||(e[13]=d("label",{for:"order_client"},"Cliente",-1)),i(u,{error:((P=(N=n.value)==null?void 0:N.client)==null?void 0:P.length)>0,type:"text",class:"rounded-lg flex-1",id:"order_client",modelValue:s.value.client,"onUpdate:modelValue":e[3]||(e[3]=o=>s.value.client=o)},null,8,["error","modelValue"])]),d("div",be,[e[14]||(e[14]=d("label",{for:"order_date"},"Fecha pedido",-1)),i(u,{error:((I=(D=n.value)==null?void 0:D.dateOrder)==null?void 0:I.length)>0,type:"datetime-local",class:"rounded-lg flex-1",id:"order_date",modelValue:s.value.dateOrder,"onUpdate:modelValue":e[4]||(e[4]=o=>s.value.dateOrder=o)},null,8,["error","modelValue"])]),d("div",Ve,[e[15]||(e[15]=d("label",null,"Procesado",-1)),d("div",xe,w(T()),1)]),d("div",ye,[i(u,{type:"checkbox",class:"rounded-lg",id:"order_served",modelValue:s.value.served,"onUpdate:modelValue":e[5]||(e[5]=o=>s.value.served=o)},null,8,["modelValue"]),e[16]||(e[16]=d("label",{for:"order_served"},"Servido",-1))]),e[21]||(e[21]=d("h3",{class:"col-span-full"},"Piezas encargadas",-1)),d("div",ke,[i($,{onClick:e[6]||(e[6]=o=>M()),"button-style":y()?"success":"warning",class:"rounded-lg",icon:!0,disabled:!y()},{default:b(()=>[i(X,{width:"24"}),V(" "+w(y()?"Añadir pieza":"Crea un ID para el pedido"),1)]),_:1},8,["button-style","disabled"]),((A=(W=n.value)==null?void 0:W.piecesEmpty)==null?void 0:A.length)>0?(a(),p("div",Ue,w(n.value.piecesEmpty[0]),1)):z("",!0)]),d("div",he,[(a(!0),p(k,null,S(s.value.pieces,(o,O)=>(a(),p("div",{key:O,class:"grid grid-cols-3 gap-3 py-3"},[i(me,{isEdit:_(x),id:o.id,"onUpdate:id":r=>o.id=r,"dimensions-length":o.dimensions.length,"onUpdate:dimensionsLength":r=>o.dimensions.length=r,"dimensions-width":o.dimensions.width,"onUpdate:dimensionsWidth":r=>o.dimensions.width=r,"dimensions-thickness":o.dimensions.thickness,"onUpdate:dimensionsThickness":r=>o.dimensions.thickness=r,color:o.color,"onUpdate:color":r=>o.color=r,"both-faces":o.bothFaces,"onUpdate:bothFaces":r=>o.bothFaces=r,cut:o.cut,"onUpdate:cut":r=>o.cut=r},null,8,["isEdit","id","onUpdate:id","dimensions-length","onUpdate:dimensionsLength","dimensions-width","onUpdate:dimensionsWidth","dimensions-thickness","onUpdate:dimensionsThickness","color","onUpdate:color","both-faces","onUpdate:bothFaces","cut","onUpdate:cut"])]))),128))]),d("div",$e,[e[19]||(e[19]=d("div",{class:"flex-1"},null,-1)),i($,{class:"rounded-lg",onClick:e[7]||(e[7]=o=>t())},{default:b(()=>e[17]||(e[17]=[V("Validar datos")])),_:1}),i($,{"button-style":"success",class:"rounded-lg",disabled:!l.value,onClick:e[8]||(e[8]=o=>q())},{default:b(()=>e[18]||(e[18]=[V("Guardar pedido")])),_:1},8,["disabled"])])])],64)}}};export{we as default};
//# sourceMappingURL=add-C4mvp8c5.js.map
